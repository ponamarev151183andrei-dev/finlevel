<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FinLevel ‚Äî –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: Arial, sans-serif;
            padding: 10px;
            background: #1a1a2e;
            color: white;
        }
        h1 {
            color: #6c5ce7;
            font-size: 24px;
            margin-bottom: 10px;
            text-align: center;
        }
        h2 {
            font-size: 18px;
            margin-bottom: 8px;
            color: #a0a0a0;
        }
        .card {
            background: #16213e;
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 12px;
        }
        .balance {
            font-size: 28px;
            font-weight: bold;
            color: #f1c40f;
        }
        .row {
            display: flex;
            gap: 8px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .category-row {
            display: flex;
            gap: 8px;
            margin: 10px 0;
        }
        .category {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }
        .needs { background: #e74c3c; }
        .wants { background: #f39c12; }
        .savings { background: #2ecc71; }
        .asset {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            background: #0f3460;
            text-align: center;
        }
        .progress-bar {
            background: #0f3460;
            height: 16px;
            border-radius: 8px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            background: #6c5ce7;
            height: 100%;
            width: 0%;
            border-radius: 8px;
            transition: width 0.3s;
        }
        .button {
            background: #6c5ce7;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: opacity 0.2s;
            margin: 4px;
        }
        .button:active {
            opacity: 0.7;
        }
        .button-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .pillow-btn { background: #27ae60; }
        .market-btn { background: #e67e22; }
        .risk-btn { background: #9b59b6; }
    </style>
</head>
<body>
    <h1>üí∞ FinLevel</h1>
    
    <!-- –£–†–û–í–ï–ù–¨ 1: –û—Å–Ω–æ–≤–Ω–æ–π —Å—á—ë—Ç -->
    <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span>üí∞ –û—Å–Ω–æ–≤–Ω–æ–π —Å—á—ë—Ç</span>
            <span class="balance" id="balance">0</span>
        </div>
        <div class="button-group">
            <button class="button" onclick="addCoin()">‚ûï +1 –º–æ–Ω–µ—Ç–∞</button>
        </div>
    </div>

    <!-- –£–†–û–í–ï–ù–¨ 2: –ü–æ–¥—É—à–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ -->
    <div class="card">
        <h2>üõ°Ô∏è –ü–æ–¥—É—à–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–£—Ä–æ–≤–µ–Ω—å 2)</h2>
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span>–ù–∞–∫–æ–ø–ª–µ–Ω–æ:</span>
            <span class="balance" style="font-size: 20px;" id="pillow">0</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="pillowProgress"></div>
        </div>
        <div style="font-size: 14px; color: #a0a0a0; margin-bottom: 10px;">
            –¶–µ–ª—å: 1000 –º–æ–Ω–µ—Ç
        </div>
        <button class="button pillow-btn" onclick="saveToPillow()">
            üõ°Ô∏è –û—Ç–ª–æ–∂–∏—Ç—å 10% –≤ –ø–æ–¥—É—à–∫—É
        </button>
    </div>

    <!-- –£–†–û–í–ï–ù–¨ 3: –ë—é–¥–∂–µ—Ç 50-30-20 -->
    <div class="card">
        <h2>üìä –ë—é–¥–∂–µ—Ç 50-30-20 (–£—Ä–æ–≤–µ–Ω—å 3)</h2>
        <div class="category-row">
            <div class="category needs">
                <div>ü•ñ –ù—É–∂–Ω–æ–µ</div>
                <div style="font-size: 18px; font-weight: bold;" id="needs">0</div>
            </div>
            <div class="category wants">
                <div>üéÆ –•–æ—Ç–µ–ª–∫–∏</div>
                <div style="font-size: 18px; font-weight: bold;" id="wants">0</div>
            </div>
            <div class="category savings">
                <div>üí∞ –°–±–µ—Ä–µ–∂.</div>
                <div style="font-size: 18px; font-weight: bold;" id="budgetSavings">0</div>
            </div>
        </div>
        <div class="button-group">
            <button class="button" onclick="distributeIncome()">üîÑ –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å 100 –º–æ–Ω–µ—Ç</button>
        </div>
        <div class="button-group">
            <button class="button" style="background: #3498db;" onclick="spend('needs', 10)">ü•ñ –ù—É–∂–Ω–æ–µ -10</button>
            <button class="button" style="background: #3498db;" onclick="spend('wants', 10)">üéÆ –•–æ—Ç–µ–ª–∫–∏ -10</button>
            <button class="button" style="background: #3498db;" onclick="spend('budgetSavings', 10)">üí∞ –°–±–µ—Ä–µ–∂. -10</button>
        </div>
    </div>

    <!-- –£–†–û–í–ï–ù–¨ 4: –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ -->
    <div class="card">
        <h2>üìà –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ (–£—Ä–æ–≤–µ–Ω—å 4)</h2>
        <div class="row">
            <div class="asset">
                <div>üìä –ê–∫—Ü–∏–∏</div>
                <div style="font-size: 18px; font-weight: bold;" id="stocks">0</div>
            </div>
            <div class="asset">
                <div>üè† –ù–µ–¥–≤–∏–∂.</div>
                <div style="font-size: 18px; font-weight: bold;" id="realty">0</div>
            </div>
            <div class="asset">
                <div>‚Çø –ö—Ä–∏–ø—Ç–∞</div>
                <div style="font-size: 18px; font-weight: bold;" id="crypto">0</div>
            </div>
        </div>
        <div class="button-group">
            <button class="button" onclick="invest('stocks', 10)">üìä –ê–∫—Ü–∏–∏ +10</button>
            <button class="button" onclick="invest('realty', 10)">üè† –ù–µ–¥–≤–∏–∂. +10</button>
            <button class="button" onclick="invest('crypto', 10)">‚Çø –ö—Ä–∏–ø—Ç–∞ +10</button>
        </div>
        <div class="button-group">
            <button class="button market-btn" onclick="updateMarket()">üîÑ –†—ã–Ω–æ—á–Ω—ã–π –¥–µ–Ω—å</button>
        </div>
    </div>

    <!-- –£–†–û–í–ï–ù–¨ 5: –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑ -->
    <div class="card">
        <h2>üìä –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è (–£—Ä–æ–≤–µ–Ω—å 5)</h2>
        <div id="riskAnalysis" style="margin: 10px 0; padding: 10px; background: #0f3460; border-radius: 8px;">
            –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        </div>
        <button class="button risk-btn" onclick="analyzeRisk()">üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∏—Å–∫–∏</button>
    </div>
    
    <!-- –£–†–û–í–ï–ù–¨ 6-7: –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –∏ —Ü–µ–ª–∏ -->
    <div class="card">
        <h2>üéØ –¶–µ–ª–∏ –∏ –¥–æ—Ö–æ–¥ (–£—Ä–æ–≤–Ω–∏ 6-7)</h2>
        <div class="button-group">
            <button class="button" onclick="collectDividends()">üíµ –°–æ–±—Ä–∞—Ç—å –¥–∏–≤–∏–¥–µ–Ω–¥—ã (1% –æ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—è)</button>
            <button class="button" style="background: #e67e22;" onclick="setGoal()">üéØ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å</button>
        </div>
        <div id="goalDisplay" style="margin-top: 10px; color: #a0a0a0;"></div>
    </div>
    
    <div class="card">
        <div class="button-group">
            <button class="button" style="background: #7f8c8d;" onclick="window.Telegram.WebApp.close()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        let coins = localStorage.getItem('finlevel_coins');
        let pillow = localStorage.getItem('finlevel_pillow');
        let needs = localStorage.getItem('finlevel_needs');
        let wants = localStorage.getItem('finlevel_wants');
        let budgetSavings = localStorage.getItem('finlevel_budgetSavings');
        let stocks = localStorage.getItem('finlevel_stocks');
        let realty = localStorage.getItem('finlevel_realty');
        let crypto = localStorage.getItem('finlevel_crypto');
        let goal = localStorage.getItem('finlevel_goal');
        
        coins = coins ? parseInt(coins) : 0;
        pillow = pillow ? parseInt(pillow) : 0;
        needs = needs ? parseInt(needs) : 0;
        wants = wants ? parseInt(wants) : 0;
        budgetSavings = budgetSavings ? parseInt(budgetSavings) : 0;
        stocks = stocks ? parseInt(stocks) : 0;
        realty = realty ? parseInt(realty) : 0;
        crypto = crypto ? parseInt(crypto) : 0;
        goal = goal ? parseInt(goal) : 10000;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã
        const balanceEl = document.getElementById('balance');
        const pillowEl = document.getElementById('pillow');
        const pillowProgress = document.getElementById('pillowProgress');
        const needsEl = document.getElementById('needs');
        const wantsEl = document.getElementById('wants');
        const budgetSavingsEl = document.getElementById('budgetSavings');
        const stocksEl = document.getElementById('stocks');
        const realtyEl = document.getElementById('realty');
        const cryptoEl = document.getElementById('crypto');
        const riskEl = document.getElementById('riskAnalysis');
        const goalEl = document.getElementById('goalDisplay');
        
        function updateAll() {
            balanceEl.textContent = coins;
            pillowEl.textContent = pillow;
            needsEl.textContent = needs;
            wantsEl.textContent = wants;
            budgetSavingsEl.textContent = budgetSavings;
            stocksEl.textContent = stocks;
            realtyEl.textContent = realty;
            cryptoEl.textContent = crypto;
            
            let percent = (pillow / 1000) * 100;
            if (percent > 100) percent = 100;
            pillowProgress.style.width = percent + '%';
            
            goalEl.textContent = `–¶–µ–ª—å: ${goal} –º–æ–Ω–µ—Ç (–æ—Å—Ç–∞–ª–æ—Å—å ${goal - coins})`;
        }
        updateAll();
        
        function saveAll() {
            localStorage.setItem('finlevel_coins', coins);
            localStorage.setItem('finlevel_pillow', pillow);
            localStorage.setItem('finlevel_needs', needs);
            localStorage.setItem('finlevel_wants', wants);
            localStorage.setItem('finlevel_budgetSavings', budgetSavings);
            localStorage.setItem('finlevel_stocks', stocks);
            localStorage.setItem('finlevel_realty', realty);
            localStorage.setItem('finlevel_crypto', crypto);
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 1
        function addCoin() {
            coins++;
            saveAll();
            updateAll();
            if (window.Telegram.WebApp.HapticFeedback) {
                window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
            }
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 2
        function saveToPillow() {
            if (coins < 1) {
                alert('–ù–µ—Ç –º–æ–Ω–µ—Ç');
                return;
            }
            let saveAmount = Math.floor(coins * 0.1);
            if (saveAmount < 1) saveAmount = 1;
            coins -= saveAmount;
            pillow += saveAmount;
            saveAll();
            updateAll();
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 3
        function distributeIncome() {
            if (coins < 100) {
                alert('–ù—É–∂–Ω–æ 100 –º–æ–Ω–µ—Ç');
                return;
            }
            coins -= 100;
            needs += 50;
            wants += 30;
            budgetSavings += 20;
            saveAll();
            updateAll();
        }
        
        function spend(category, amount) {
            if (coins < amount) {
                alert('–ù–µ—Ç –º–æ–Ω–µ—Ç');
                return;
            }
            coins -= amount;
            if (category === 'needs') needs += amount;
            if (category === 'wants') wants += amount;
            if (category === 'budgetSavings') budgetSavings += amount;
            saveAll();
            updateAll();
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 4
        function invest(asset, amount) {
            if (coins < amount) {
                alert('–ù–µ—Ç –º–æ–Ω–µ—Ç');
                return;
            }
            coins -= amount;
            if (asset === 'stocks') stocks += amount;
            if (asset === 'realty') realty += amount;
            if (asset === 'crypto') crypto += amount;
            saveAll();
            updateAll();
        }
        
        function updateMarket() {
            let stocksChange = Math.floor(Math.random() * 50) - 20;
            let realtyChange = Math.floor(Math.random() * 25) - 10;
            let cryptoChange = Math.floor(Math.random() * 120) - 40;
            
            stocks = Math.max(0, stocks + Math.floor(stocks * stocksChange / 100));
            realty = Math.max(0, realty + Math.floor(realty * realtyChange / 100));
            crypto = Math.max(0, crypto + Math.floor(crypto * cryptoChange / 100));
            
            saveAll();
            updateAll();
            alert(`–†—ã–Ω–æ–∫:\n–ê–∫—Ü–∏–∏: ${stocksChange}%\n–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å: ${realtyChange}%\n–ö—Ä–∏–ø—Ç–∞: ${cryptoChange}%`);
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 5
        function analyzeRisk() {
            let total = stocks + realty + crypto;
            if (total === 0) {
                riskEl.textContent = '–ù–µ—Ç –∞–∫—Ç–∏–≤–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞';
                return;
            }
            let stocksPct = (stocks / total * 100).toFixed(1);
            let realtyPct = (realty / total * 100).toFixed(1);
            let cryptoPct = (crypto / total * 100).toFixed(1);
            
            let risk = 'üü¢ –ù–∏–∑–∫–∏–π';
            if (crypto > total * 0.3) risk = 'üî¥ –í—ã—Å–æ–∫–∏–π (–º–Ω–æ–≥–æ –∫—Ä–∏–ø—Ç—ã)';
            else if (stocks > total * 0.5) risk = 'üü° –°—Ä–µ–¥–Ω–∏–π';
            
            riskEl.innerHTML = `
                üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:<br>
                –ê–∫—Ü–∏–∏: ${stocksPct}%<br>
                –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å: ${realtyPct}%<br>
                –ö—Ä–∏–ø—Ç–∞: ${cryptoPct}%<br>
                –†–∏—Å–∫: ${risk}
            `;
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 6
        function collectDividends() {
            let dividend = Math.floor((stocks + realty + crypto) * 0.01);
            if (dividend < 1) dividend = 1;
            coins += dividend;
            saveAll();
            updateAll();
            alert(`–ü–æ–ª—É—á–µ–Ω–æ ${dividend} –º–æ–Ω–µ—Ç –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤`);
        }
        
        // –£—Ä–æ–≤–µ–Ω—å 7
        function setGoal() {
            let newGoal = prompt('–í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª—å (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç):', goal);
            if (newGoal && !isNaN(newGoal)) {
                goal = parseInt(newGoal);
                localStorage.setItem('finlevel_goal', goal);
                updateAll();
            }
        }
        
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
    </script>
</body>
</html>
